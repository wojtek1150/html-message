{"version":3,"file":"html-message.umd.js","sources":["ng://html-message/lib/components/html-message.component.ts","ng://html-message/lib/components/html-preview-message.component.ts","ng://html-message/lib/html-parser.service.ts","ng://html-message/lib/pipes/html-parser.pipe.ts","ng://html-message/lib/pipes/html-preview.pipe.ts","ng://html-message/lib/pipes/save-html.pipe.ts","ng://html-message/lib/html-message.module.ts"],"sourcesContent":["import { ChangeDetectionStrategy, Component, Input, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'lib-html-message',\n  template: `\n    <div class=\"message\" [innerHtml]=\"message | htmlParser | safeHtml\"></div>\n  `,\n  styleUrls: ['./html-message.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None\n})\nexport class HtmlMessageComponent {\n  @Input() message: string;\n}\n","import { ChangeDetectionStrategy, Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'lib-html-message-preview',\n  template: `\n    <p>{{message | htmlPreview:length}}</p>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class HtmlPreviewMessageComponent {\n  @Input() message: string;\n  @Input() length = 100;\n}\n","// OLD FOR TEXT MAILS TO HMTL MAILS\nconst REG_CID1 = new RegExp('(\\[cid:[^\\s]+])<([^>]+)><([^>]+)>', 'gmi');\nconst REG_CID2 = new RegExp('(\\\\[cid:[^\\\\s]+])\\\\s+<([^>]+)><([^>]+)>', 'gmi');\nconst REG_LINKS = new RegExp('([^\\\\s<]+)<([^>]+)>', 'gmi');\nconst REG_TRIM_START = new RegExp('^(\\\\s)*');\nconst REG_TRIM_END = new RegExp('(\\\\s)*$');\nconst REG_WHITE_SPACE = new RegExp('\\\\n', 'g');\n// END\nexport const REG_IMAGES = new RegExp('(<img.*\">)', 'gmi');\nexport const REG_OUTLOCK = new RegExp('(_{32}.From.*)', 'gmi');\n\n\nexport class HtmlParserService {\n\n  private static removeCid(s: string): string {\n    return s.replace(REG_CID1, '').replace(REG_CID2, '');\n  }\n\n  private static parseLinks(s: string): string {\n    const replacer = (match, text, url) => match ? `<a href=\"${url}\" target=\"_blank\" rel=\"nofollow\">${text}</a>` : '';\n    return s.replace(REG_LINKS, replacer);\n  }\n\n  private static trim(s: string): string {\n    return s.replace(REG_TRIM_START, '').replace(REG_TRIM_END, '');\n  }\n\n  private static parseHtml(s: string): string {\n    return s\n      .replace('<html><body>', '').replace('</body></html>', '') // Replace wrap\n      .replace('style=\\\"text-align:right;\\\"', 'class=\\\"align-right\\\"') // Replace Align Right\n      .replace('style=\\\"text-align:center;\\\"', 'class=\\\"align-center\\\"') // Replace Align Center\n      .replace(REG_IMAGES, '') // Remove IMGS\n      .replace(REG_OUTLOCK, ''); // Remove Outlock Footer\n  }\n\n  static parse(s: string): string {\n    if (!s) { return ''; }\n    if (s.includes('[cid:')) { // FALLBACK FOR TEXT ONLY MESSAGES\n      return this.trim(this.parseLinks(this.removeCid(s))).replace(REG_WHITE_SPACE, '<br/>');\n    }\n    return this.parseHtml(s);\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { HtmlParserService } from '../html-parser.service';\n\n@Pipe({\n  name: 'htmlParser'\n})\nexport class HtmlParserPipe implements PipeTransform {\n\n  transform(value: string): string {\n    return HtmlParserService.parse(value);\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { REG_OUTLOCK } from '../html-parser.service';\n\n@Pipe({\n  name: 'htmlPreview'\n})\nexport class HtmlPreviewPipe implements PipeTransform {\n\n  transform(value: string, length: number): string {\n    return value\n      .replace(REG_OUTLOCK, '')\n      .replace(/<[^>]*>?/gm, '')\n      .replace('&nbsp;', ' ')\n      .substr(0, length === -1 ? Infinity : length);\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({ name: 'safeHtml' })\nexport class SafeHtmlPipe implements PipeTransform {\n  constructor(private sanitized: DomSanitizer) {}\n\n  transform(value) {\n    return this.sanitized.bypassSecurityTrustHtml(value);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { HtmlMessageComponent } from './components/html-message.component';\nimport { HtmlPreviewMessageComponent } from './components/html-preview-message.component';\n\nimport { HtmlParserPipe } from './pipes/html-parser.pipe';\nimport { HtmlPreviewPipe } from './pipes/html-preview.pipe';\nimport { SafeHtmlPipe } from './pipes/save-html.pipe';\n\n@NgModule({\n  declarations: [\n    HtmlMessageComponent,\n    HtmlPreviewMessageComponent,\n    HtmlParserPipe,\n    HtmlPreviewPipe,\n    SafeHtmlPipe\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [HtmlMessageComponent, HtmlPreviewMessageComponent]\n})\nexport class HtmlMessageModule {}\n"],"names":["Component","ChangeDetectionStrategy","ViewEncapsulation","Input","Pipe","DomSanitizer","NgModule","CommonModule"],"mappings":"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"}